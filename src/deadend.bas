1 REM DEAD END - IDEA ORIGINAL: WOLFGANG THALLER FOR MACINTOSH (C) 1993-1998
2 REM PROGRAMA: MIGUEL A. GARCIA PRADA FOR ZX-SPECTRUM 2019
3 REM GRAFICOS: JAVIER VISPE
4 REM PORT COMMODORE 64: FEDE J. ALVAREZ VALERO
5 REM (C) 2019 COMPILER SOFTWARE - COMPILER.SPECCY.ORG
6 REM POKE 56,192: REM CLEAR 49152
7 GOSUB 9000
10 GOTO 300

20 REM UDG
21 REM MURO 64,65,66,67 -> 192,193,194,195
22 DATA 64,0,170,254,254,0,239,239,239
23 DATA 65,0,170,254,254,0,239,239,239
24 DATA 66,0,254,254,254,0,239,239,170
25 DATA 67,0,254,254,254,0,239,239,170

30 REM EMPUJABLE 68,69,70,71 -> 196,197,198,199
31 DATA 68,0,127,127,0,111,111,96,109
32 DATA 69,0,254,254,0,182,118,230,214
33 DATA 70,107,103,110,109,0,127,127,0
34 DATA 71,182,6,246,246,0,254,254,0

35 REM PROTA 72,73,74,75 -> 200,201,202,203
36 DATA 72,0,7,24,32,64,64,64,56
37 DATA 73,0,224,24,100,18,2,2,28
38 DATA 74,71,120,71,86,71,126,31,0
39 DATA 75,226,10,210,170,210,166,248,0

40 REM CARACTER ROTULO DEAD END_ 76 -> 204
41 DATA 76,0,85,0,170,85,170,255,255

45 REM SALIDA 77,78,79,80 -> 205,206,207,208
46 DATA 77,0,42,85,0,127,74,90,77
47 DATA 78,0,170,84,0,254,162,182,182
48 DATA 79,90,74,127,127,0,42,85,0
49 DATA 80,182,182,254,254,0,170,84,0

50 REM CARACTER MARCO FINAL DE NIVEL 81 -> 209
51 DATA 81,170,85,170,85,170,85,170,85

60 REM NIVEL 1
61 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
62 DATA 0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0
63 DATA 0,0,0,1,1,1,1,3,1,1,1,1,0,0,0,0
64 DATA 0,1,1,1,0,2,0,2,0,0,0,1,1,1,0,0
65 DATA 1,1,0,0,0,0,2,2,2,0,2,0,0,1,1,0
66 DATA 1,2,0,2,0,2,0,2,0,0,0,2,0,2,1,0
67 DATA 1,2,0,0,2,0,2,2,2,2,2,0,0,2,1,0
68 DATA 1,2,2,2,0,2,0,0,2,0,0,2,2,2,1,0
69 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0
70 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
71 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
72 DATA 14,14

80 REM NIVEL 2
81 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
82 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0
83 DATA 1,0,0,2,0,2,0,0,0,2,0,2,0,3,1,0
84 DATA 1,0,0,2,0,2,0,2,2,2,2,0,2,0,1,0
85 DATA 1,0,0,2,0,2,0,0,0,2,0,2,0,0,1,0
86 DATA 1,0,0,2,0,2,0,2,2,0,2,0,2,0,1,0
87 DATA 1,0,0,2,0,2,0,0,0,2,0,2,0,2,1,0
88 DATA 1,0,0,2,0,2,0,2,2,0,2,0,2,0,1,0
89 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0
90 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
91 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
92 DATA 2,8


100 REM NIVEL 3
101 DATA 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0
102 DATA 0,1,0,0,0,2,2,0,0,0,0,0,2,0,1,0
103 DATA 0,1,0,0,0,0,0,0,2,2,0,2,0,2,1,0
104 DATA 0,1,0,0,0,2,2,0,2,0,2,0,2,0,1,0
105 DATA 0,1,0,0,2,2,0,0,2,2,2,2,2,0,1,0
106 DATA 0,1,0,0,2,0,2,0,2,0,0,0,0,0,1,0
107 DATA 0,1,0,0,0,2,0,2,0,0,2,0,0,2,1,0
108 DATA 0,1,0,0,0,0,2,0,2,0,2,2,2,2,1,0
109 DATA 0,1,0,0,0,2,2,0,0,2,2,2,3,0,1,0
110 DATA 0,1,0,0,0,2,2,0,0,2,0,0,0,0,1,0
111 DATA 0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0
112 DATA 4,10

120 REM NIVEL 4
121 DATA 0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0
122 DATA 0,0,0,0,0,1,0,1,0,0,0,0,1,0,0,0
123 DATA 0,0,1,1,1,0,1,1,2,2,0,2,0,1,0,0
124 DATA 0,1,0,1,1,0,1,0,0,2,0,0,0,1,0,0
125 DATA 0,1,0,0,0,2,2,0,0,0,2,0,2,1,0,0
126 DATA 0,1,2,0,2,0,2,0,0,0,2,2,0,1,0,0
127 DATA 0,1,0,1,1,0,1,0,2,2,0,2,2,1,0,0
128 DATA 0,0,1,1,1,0,1,1,0,2,0,0,3,1,0,0
129 DATA 0,0,0,0,0,1,0,1,2,0,0,0,1,0,0,0
130 DATA 0,0,0,0,0,0,1,0,1,1,1,1,0,0,0,0
131 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
132 DATA 10,14

140 REM NIVEL 5
141 DATA 0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0
142 DATA 0,0,0,0,0,0,1,3,1,0,0,0,0,0,0,0
143 DATA 0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0
144 DATA 0,0,0,0,1,0,2,2,2,0,1,0,0,0,0,0
145 DATA 0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0
146 DATA 0,0,1,0,2,2,2,2,2,2,2,0,1,0,0,0
147 DATA 0,0,0,1,0,0,2,0,2,0,0,1,0,0,0,0
148 DATA 0,0,0,0,1,0,0,2,0,0,1,0,0,0,0,0
149 DATA 0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0
150 DATA 0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0
151 DATA 0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0
152 DATA 14,18

160 REM NIVEL 6
161 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
162 DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0
163 DATA 0,0,1,0,0,0,0,0,0,0,2,0,0,1,0,0
164 DATA 0,0,1,2,0,0,2,0,0,2,0,0,0,1,0,0
165 DATA 0,0,1,0,2,2,2,2,2,0,2,2,2,1,0,0
166 DATA 0,0,1,0,2,0,0,2,0,2,2,0,0,1,0,0
167 DATA 0,0,1,0,2,0,0,2,0,2,0,0,2,1,0,0
168 DATA 0,0,1,3,0,2,0,0,0,1,2,0,0,1,0,0
169 DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0
170 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
171 DATA 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
172 DATA 24,10

180 REM NIVEL 7
181 DATA 0,0,0,1,0,1,0,1,0,1,0,1,0,1,0,0
182 DATA 0,0,1,0,1,0,1,0,1,0,1,0,1,0,1,0
183 DATA 0,1,0,0,2,0,2,0,2,0,2,0,2,2,0,1
184 DATA 0,0,1,0,0,2,0,0,0,0,0,0,0,0,0,1
185 DATA 0,1,0,2,2,2,2,2,2,2,2,2,2,2,1,1
186 DATA 1,0,0,0,2,0,0,2,0,0,0,0,0,0,0,1
187 DATA 0,1,0,1,0,0,2,0,2,0,2,0,2,2,1,1
188 DATA 0,0,1,0,2,0,0,2,2,0,2,0,2,0,0,1
189 DATA 0,1,0,0,2,0,2,0,2,0,2,0,2,0,2,1
190 DATA 0,0,1,0,3,1,0,1,0,1,0,1,0,1,1,0
191 DATA 0,0,0,1,0,0,1,0,1,0,1,0,1,0,0,0
192 DATA 6,4

200 REM NIVEL 8
201 DATA 0,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0
202 DATA 0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0
203 DATA 0,1,0,1,1,1,1,1,1,0,1,0,1,1,0,0
204 DATA 0,1,0,1,0,0,2,0,1,0,0,1,0,1,0,0
205 DATA 0,1,0,1,0,0,2,0,0,2,2,2,0,0,1,0
206 DATA 0,1,0,0,2,0,0,2,2,0,0,0,2,2,1,0
207 DATA 0,1,0,1,0,0,2,0,0,2,0,2,0,3,1,0
208 DATA 0,1,0,1,0,0,2,2,1,0,2,1,0,1,1,0
209 DATA 0,1,0,1,1,1,1,1,1,0,0,1,0,0,0,0
210 DATA 0,1,0,0,0,0,0,0,0,0,0,1,2,0,0,0
211 DATA 0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0
212 DATA 6,10

220 REM NIVEL 9
221 DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0
222 DATA 0,0,1,1,3,2,0,2,0,2,0,0,1,1,0,0
223 DATA 0,0,1,0,0,2,0,2,0,2,0,2,0,1,0,0
224 DATA 0,0,1,0,1,0,0,2,0,0,0,0,0,1,0,0
225 DATA 0,0,1,0,2,0,0,0,0,2,0,2,0,1,0,0
226 DATA 0,0,1,2,0,2,2,0,2,0,2,2,2,1,0,0
227 DATA 0,0,1,0,2,0,2,2,2,2,0,2,0,1,0,0
228 DATA 0,0,1,0,0,0,2,0,0,0,2,0,0,1,0,0
229 DATA 0,0,1,0,2,0,2,0,2,0,2,0,0,1,0,0
230 DATA 0,0,1,1,0,0,0,0,2,0,2,0,1,1,0,0
231 DATA 0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0
232 DATA 8,18

240 REM NIVEL 10
241 DATA 0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0
242 DATA 0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0
243 DATA 0,0,0,1,1,1,0,2,0,0,0,1,1,1,0,0
244 DATA 0,1,1,1,0,2,0,0,2,0,2,0,0,1,1,1
245 DATA 1,1,0,0,2,0,2,0,0,2,0,0,2,0,0,1
246 DATA 1,0,0,2,0,2,0,2,2,2,2,2,2,0,0,3
247 DATA 1,1,0,0,2,0,2,2,0,2,0,0,2,0,2,1
248 DATA 0,1,1,1,0,2,0,0,2,0,0,2,0,1,1,1
249 DATA 0,0,0,1,1,1,0,2,0,0,0,1,1,1,0,0
250 DATA 0,0,0,0,0,1,1,1,0,1,1,1,0,0,0,0
251 DATA 0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0
252 DATA 2,10

260 REM NIVEL TEST
261 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
262 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
263 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
264 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
265 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
266 DATA 1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,1
267 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
268 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
269 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
270 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
271 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
272 DATA 14,2

299 END

300 REM MENU DEL JUEGO
305 POKE 646,6: PRINT CHR$(147)
310 POKE 781,1: POKE 782,11: SYS 65520: PRINT CHR$(159)+CHR$(204)+CHR$(204)+CHR$(204)+"  "+CHR$(204)+CHR$(204)+CHR$(204)+"  "+CHR$(204)+CHR$(204)+CHR$(204)+CHR$(204)+" "+CHR$(204)+CHR$(204)+CHR$(204);
311 POKE 781,2: POKE 782,11: SYS 65520: PRINT CHR$(31)+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+"    "+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204);
312 POKE 781,3: POKE 782,11: SYS 65520: PRINT CHR$(151)+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+"    "+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204);
313 POKE 781,4: POKE 782,11: SYS 65520: PRINT CHR$(28)+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+CHR$(204)+CHR$(204)+"  "+CHR$(204)+CHR$(204)+CHR$(204)+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204);
314 POKE 781,5: POKE 782,11: SYS 65520: PRINT CHR$(158)+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+"    "+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204);
315 POKE 781,6: POKE 782,11: SYS 65520: PRINT CHR$(5)+CHR$(204)+CHR$(204)+CHR$(204)+"  "+CHR$(204)+CHR$(204)+CHR$(204)+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+CHR$(204)+CHR$(204);
316 POKE 781,8: POKE 782,11: SYS 65520: PRINT CHR$(159)+CHR$(204)+CHR$(204)+CHR$(204)+"  "+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+CHR$(204)+CHR$(204);
317 POKE 781,9: POKE 782,11: SYS 65520: PRINT CHR$(31)+CHR$(204)+"    "+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204);
318 POKE 781,10: POKE 782,11: SYS 65520: PRINT CHR$(151)+CHR$(204)+"    "+CHR$(204)+CHR$(204)+" "+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204);
319 POKE 781,11: POKE 782,11: SYS 65520: PRINT CHR$(28)+CHR$(204)+CHR$(204)+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204);
320 POKE 781,12: POKE 782,11: SYS 65520: PRINT CHR$(158)+CHR$(204)+"    "+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204);
321 POKE 781,13: POKE 782,11: SYS 65520: PRINT CHR$(5)+CHR$(204)+CHR$(204)+CHR$(204)+CHR$(204)+" "+CHR$(204)+"  "+CHR$(204)+" "+CHR$(204)+CHR$(204)+CHR$(204)+"  "+CHR$(204)+CHR$(204)+CHR$(204)+CHR$(204);
322 POKE 781,16: POKE 782,16: SYS 65520: PRINT CHR$(31)+CHR$(18)+"N"+CHR$(146)+"IVEL ";: PRINT NIVEL+1;
323 POKE 781,18: POKE 782,16: SYS 65520: PRINT CHR$(18)+"C"+CHR$(146)+"OMIENZA";
324 POKE 781,20: POKE 782,18: SYS 65520: PRINT CHR$(18)+"I"+CHR$(146)+"NFO";
325 POKE 781,23: POKE 782,8: SYS 65520: PRINT "(C)COMPILER SOFTWARE 2019";
326 POKE 781,24: POKE 782,11: SYS 65520: PRINT "COMPILER.SPECCY.ORG"+CHR$(145);
330 GET A$
331 IF A$="I" OR A$="i" THEN GOTO 400
332 IF A$="C" OR A$="c" THEN GOTO 500
333 IF A$="N" OR A$="n" THEN GOTO 340
334 GOTO 330
340 NIVEL=NIVEL+1: IF NIVEL=10 THEN NIVEL=0
341 NX=22: IF NIVEL=9 THEN NX=21
342 POKE 781,16: POKE 782,NX: SYS 65520: PRINT NIVEL+1;: PRINT CHR$(157)+"  ";
343 GET A$: IF A$<>"" THEN GOTO 343
344 GOTO 330

400 REM INFO
405 POKE 646,6: PRINT CHR$(147)
410 POKE 781,20: POKE 782,6: SYS 65520: PRINT "2019 MIGUEL G. PRADA PARA EL"
415 POKE 781,21: POKE 782,4: SYS 65520: PRINT "CONCURSO BASIC BYTEMANIACOS 2020"
417 POKE 781,23: POKE 782,2: SYS 65520: PRINT "PORT COMMODORE 64 POR FEDE J. ALVAREZ"
418 POKE 781,24: POKE 782,14: SYS 65520: PRINT "VERSION 1.0"
420 POKE 781,2: POKE 782,7: SYS 65520: PRINT "DEAD END ESTA BASADO EN EL"
425 POKE 781,3: POKE 782,5: SYS 65520: PRINT "JUEGO DEL MISMO NOMBRE, CREADO"
430 POKE 781,4: POKE 782,4: SYS 65520: PRINT "PARA MACINTOSH ENTRE 1993 Y 1998"
435 POKE 781,5: POKE 782,10: SYS 65520: PRINT "POR WOLFGANG THALLER"
437 POKE 781,7: POKE 782,7: SYS 65520: PRINT "GRAFICOS GRACIAS A J.VISPE"
440 POKE 781,12: POKE 782,8: SYS 65520: PRINT "EL JUEGO SE CONTROLA CON"
450 POKE 781,14: POKE 782,6: SYS 65520: PRINT "O - IZQUIERDA    P - DERECHA"
455 POKE 781,15: POKE 782,6: SYS 65520: PRINT "Q - ARRIBA       A - ABAJO"
460 POKE 781,16: POKE 782,6: SYS 65520: PRINT "R - REINICIA EL NIVEL"
465 POKE 781,17: POKE 782,6: SYS 65520: PRINT "Y - REGRESA AL MENU"
480 GET A$: IF A$<>"" THEN GOTO 480
485 GET A$: IF A$<>"" THEN GOTO 300
490 GOTO 485

500 REM LANZANDO EL NIVEL
510 MOV=0
515 POKE 781,23: POKE 782,0: SYS 65520 
516 PRINT CHR$(31);: FOR I=0 TO 39: PRINT CHR$(204);: NEXT I
520 POKE 781,24: POKE 782,0: SYS 65520 
521 PRINT CHR$(159)+"   Nivel: "+STR$(NIVEL+1)+"       Movimientos:    "+STR$(MOV);
522 GOSUB 800
525 GOSUB 1000
532 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT V$;
533 POKE 781,YPROTA+1+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT W$;
535 PUNT=((YPROTA/2)*16)+(XPROTA/2)
540 GOTO 1100

800 REM BARRIDO CLS
805 FOR F=21 TO 0 STEP -1
810 POKE 781,F: POKE 782,0: SYS 65520: PRINT CHR$(144)+"                                        ";
815 NEXT F
820 RETURN

900 REM FINAL DEL NIVEL
901 NIVEL=NIVEL+1: IF NIVEL=10 THEN NIVEL=0
902 C$="": FOR F=0 TO 29: C$=C$+CHR$(209): NEXT F
905 POKE 781,5: POKE 782,5: SYS 65520: PRINT CHR$(159)+C$;
910 FOR F=6 TO 14
915 POKE 781,F: POKE 782,5: SYS 65520: PRINT CHR$(159)+CHR$(209)+"                            "+CHR$(209);
920 NEXT F
925 POKE 781,15: POKE 782,5: SYS 65520: PRINT CHR$(159)+C$;
930 POKE 781,8: POKE 782,12: SYS 65520: PRINT CHR$(159)+"NIVEL COMPLETADO";
931 POKE 781,10: POKE 782,12: SYS 65520: PRINT "MOVIMIENTOS "; 
932 NX=26
933 IF MOV>9 THEN NX=25
934 IF MOV>99 THEN NX=24
935 IF MOV>999 THEN NX=23
936 POKE 781,10: POKE 782,NX: SYS 65520: PRINT MOV;
937 POKE 781,12: POKE 782,12: SYS 65520: PRINT "PROXIMO NIVEL ";
938 NX=26: IF NIVEL=9 THEN NX=25
939 POKE 781,12: POKE 782,NX: SYS 65520: PRINT NIVEL+1;
940 GET A$: IF A$<>"" THEN GOTO 940
945 GET A$: IF A$<>"" THEN GOTO 500
949 GOTO 945

1000 REM MAPEANDO
1005 XTILE=0: YTILE=0
1010 GOSUB 8000
1015 FOR F=0 TO BFL: READ A: BUFFER(F)=A
1016 PRINT CHR$(31);: PRINT "";: REM SIN ESTA LINEA NO SE PINTAN LOS TILES
1020 IF A=0 THEN GOTO 1050
1025 IF A=1 THEN GOSUB 8110: GOTO 1050
1026 IF A=2 THEN GOSUB 8120: GOTO 1050
1030 IF A=3 THEN GOSUB 8130: GOTO 1050
1050 XTILE=XTILE+2
1055 IF XTILE>=32 THEN XTILE=0: YTILE=YTILE+2
1060 NEXT F
1065 READ XPROTA: READ YPROTA
1070 RETURN

1100 REM BUCLE PRINCIPAL
1105 GET T$
1210 IF T$="O" OR T$="o" THEN GOTO 1300
1215 IF T$="P" OR T$="p" THEN GOTO 1400
1220 IF T$="Q" OR T$="q" THEN GOTO 1500
1225 IF T$="A" OR T$="a" THEN GOTO 1600
1230 IF T$="R" OR T$="r" THEN GOTO 500
1235 IF T$="Y" OR T$="y" THEN GOTO 300
1245 GOTO 1105

1300 REM MOVIMIENTO IZQUIERDA
1305 PUNT=PUNT-1: B1=BUFFER(PUNT): PUNT=PUNT-1: B2=BUFFER(PUNT): PUNT=PUNT+3: B3=BUFFER(PUNT): PUNT=PUNT-1
1310 IF B1<>0 THEN GOTO 1320
1315 GOSUB 2000: GOSUB 2000: PUNT=PUNT-1: GOTO 1895
1320 IF B1=2 AND B2=0 AND B3=0 THEN GOTO 1350
1325 IF B1=3 THEN GOSUB 2000: GOSUB 2000: GOTO 900
1330 GOTO 1905
1350 REM EMPUJAMOS A LA IZQUIERDA
1355 PUNT=PUNT-1: BUFFER(PUNT)=0: BUFFER(PUNT-1)=2
1357 GOSUB 2050: GOSUB 2050: GOSUB 2000: GOSUB 2000
1360 XPROTA=XPROTA-1
1365 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA-2+XOFFSET: SYS 65520: PRINT X$+V$+" ";
1366 POKE 781,YPROTA+1+YOFFSET: POKE 782,XPROTA-2+XOFFSET: SYS 65520: PRINT Y$+W$+" ";
1370 XPROTA=XPROTA-1
1375 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA-2+XOFFSET: SYS 65520: PRINT X$+V$+" ";
1376 POKE 781,YPROTA+1+YOFFSET: POKE 782,XPROTA-2+XOFFSET: SYS 65520: PRINT Y$+W$+" ";
1380 GOTO 1895

1400 REM MOVIMIENTO DERECHA
1405 PUNT=PUNT+1: B1=BUFFER(PUNT): PUNT=PUNT+1: B2=BUFFER(PUNT): PUNT=PUNT-3: B3=BUFFER(PUNT): PUNT=PUNT+1
1410 IF B1<>0 THEN GOTO 1420
1415 GOSUB 2050: GOSUB 2050: PUNT=PUNT+1: GOTO 1895
1420 IF B1=2 AND B2=0 AND B3=0 THEN GOTO 1450
1425 IF B1=3 THEN GOSUB 2050: GOSUB 2050: GOTO 900
1430 GOTO 1905
1450 REM EMPUJAMOS A LA DERECHA
1455 PUNT=PUNT+1: BUFFER(PUNT)=0: BUFFER(PUNT+1)=2
1457 GOSUB 2000: GOSUB 2000: GOSUB 2050: GOSUB 2050
1460 XPROTA=XPROTA+1
1465 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA-1+XOFFSET: SYS 65520: PRINT " "+V$+X$;
1466 POKE 781,YPROTA+1+YOFFSET: POKE 782,XPROTA-1+XOFFSET: SYS 65520: PRINT " "+W$+Y$;
1470 XPROTA=XPROTA+1
1475 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA-1+XOFFSET: SYS 65520: PRINT " "+V$+X$;
1476 POKE 781,YPROTA+1+YOFFSET: POKE 782,XPROTA-1+XOFFSET: SYS 65520: PRINT " "+W$+Y$;
1480 GOTO 1895

1500 REM MOVIMIENTO ARRIBA
1505 PUNT=PUNT-16: GOSUB 7000: B1=BUFV: PUNT=PUNT-16: GOSUB 7000: B2=BUFV: PUNT=PUNT+48: GOSUB 7000: B3=BUFV: PUNT=PUNT-16
1510 IF B1<>0 THEN GOTO 1520
1515 GOSUB 2075: GOSUB 2075: PUNT=PUNT-16: GOTO 1895
1520 IF B1=2 AND B2=0 AND B3=0 THEN GOTO 1550
1525 IF B1=3 THEN GOSUB 2075: GOSUB 2075: GOTO 900
1530 GOTO 1905
1550 REM EMPUJAMOS ARRIBA
1555 PUNT=PUNT-16: BUFFER(PUNT)=0: BUFFER(PUNT-16)=2
1557 GOSUB 3025: GOSUB 3025: GOSUB 2075: GOSUB 2075
1565 POKE 781,YPROTA-3+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT X$+CHR$(157)+CHR$(157)+CHR$(17)+Y$;: GOSUB 2075
1575 POKE 781,YPROTA-3+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT X$+CHR$(157)+CHR$(157)+CHR$(17)+Y$;: GOSUB 2075
1580 GOTO 1895

1600 REM MOVIMIENTO ABAJO
1605 PUNT=PUNT+16: GOSUB 7000: B1=BUFV: PUNT=PUNT+16: GOSUB 7000: B2=BUFV: PUNT=PUNT-48: GOSUB 7000: B3=BUFV: PUNT=PUNT+16
1610 IF B1<>0 THEN GOTO 1620
1615 GOSUB 3025: GOSUB 3025: PUNT=PUNT+16: GOTO 1895
1620 IF B1=2 AND B2=0 AND B3=0 THEN GOTO 1650
1625 IF B1=3 THEN GOSUB 3025: GOSUB 3025: GOTO 900
1630 GOTO 1905
1650 REM EMPUJAMOS ABAJO
1655 PUNT=PUNT+16: BUFFER(PUNT)=0: BUFFER(PUNT+16)=2
1657 GOSUB 2075: GOSUB 2075: GOSUB 3025: GOSUB 3025
1665 POKE 781,YPROTA+3+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT X$+CHR$(157)+CHR$(157)+CHR$(17)+Y$;: GOSUB 3025
1675 POKE 781,YPROTA+3+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT X$+CHR$(157)+CHR$(157)+CHR$(17)+Y$;: GOSUB 3025
1680 GOTO 1895

1895 REM ACTUALIZA MARCADOR MOVIMIENTOS
1896 MOV=MOV+1: NX=0: IF MOV>9999 THEN MOV=9999
1897 IF MOV>9 THEN NX=1
1898 IF MOV>99 THEN NX=2
1899 IF MOV>999 THEN NX=3
1900 POKE 781,24: POKE 782,35-NX: SYS 65520: PRINT CHR$(159)+STR$(MOV);
1905 GOTO 1100

2000 REM PINTA PERSONAJE UN PASO A LA IZQUIERDA BORRANDO RASTRO
2005 XPROTA=XPROTA-1
2010 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT V$+" "+CHR$(157)+CHR$(157)+CHR$(157)+CHR$(17)+W$+" ";
2012 POKE 54296,15:POKE 54296,0
2015 RETURN

2050 REM PINTA PERSONAJE UN PASO A LA DERECHA BORRANDO RASTRO
2055 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT " "+V$+CHR$(157)+CHR$(157)+CHR$(157)+CHR$(17)+" "+W$;
2060 XPROTA=XPROTA+1
2062 POKE 54296,15:POKE 54296,0
2065 RETURN

2075 REM PINTA PERSONAJE UN PASO ARRIBA BORRANDO RASTRO
2080 YPROTA=YPROTA-1
2085 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT V$;
2086 POKE 781,YPROTA+1+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT W$;
2087 POKE 781,YPROTA+2+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT "  ";
2088 POKE 54296,15:POKE 54296,0
2090 RETURN

3025 REM PINTA PERSONAJE UN PASO ABAJO BORRANDO RASTRO
3030 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT "  ";
3035 YPROTA=YPROTA+1
3040 POKE 781,YPROTA+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT V$;
3041 POKE 781,YPROTA+1+YOFFSET: POKE 782,XPROTA+XOFFSET: SYS 65520: PRINT W$;
3042 POKE 54296,15:POKE 54296,0
3045 RETURN

7000 REM LEE BUFFER 
7001 REM PUNT = INDICE
7002 REM BUFV = BUFFER(PUNT) O 0 SI PUNT FUERA DE RANGO
7005 BUFV=0
7006 IF PUNT<0 THEN RETURN
7007 IF PUNT>BFL THEN RETURN
7008 BUFV=BUFFER(PUNT)
7010 RETURN

8000 REM RESTAURA DATOS DE NIVELES
8001 REM SITUA EL PUNTERO EN EL NIVEL CORRESPONDIENTE LEYENDO Y DESCARTANDO LOS DATOS ANTERIORES
8003 RESTORE: FOR F=1 TO (18*9)+(178*NIVEL): READ A: NEXT F
8005 RETURN

8100 REM RUTINAS PINTADO TILES MAPA
8110 POKE 781,YTILE+YOFFSET: POKE 782,XTILE+XOFFSET: SYS 65520 
8111 PRINT CHR$(28)+CHR$(192)+CHR$(193)+CHR$(157)+CHR$(157)+CHR$(17)+CHR$(150)+CHR$(194)+CHR$(195);
8112 RETURN
8120 POKE 781,YTILE+YOFFSET: POKE 782,XTILE+XOFFSET: SYS 65520
8121 PRINT X$+CHR$(157)+CHR$(157)+CHR$(17)+Y$;
8122 RETURN
8130 POKE 781,YTILE+YOFFSET: POKE 782,XTILE+XOFFSET: SYS 65520
8131 PRINT CHR$(156)+CHR$(205)+CHR$(206)+CHR$(157)+CHR$(157)+CHR$(17)+CHR$(207)+CHR$(208);
8132 RETURN

9000 REM INIT
9001 POKE 53280,0: POKE 53281,0: REM BORDER 0 PAPER 0
9002 BFL=175: DIM BUFFER(BFL)
9003 XOFFSET=4: YOFFSET=0: REM POSICION DEL JUEGO AL PINTAR (CENTRADO EN PANTALLA)
9004 NIVEL=0: NX=0
9005 V$=CHR$(5)+CHR$(200)+CHR$(201): REM PARTE ARRIBA PROTA
9006 W$=CHR$(159)+CHR$(202)+CHR$(203): REM PARTE ABAJO PROTA
9007 X$=CHR$(158)+CHR$(196)+CHR$(197): REM PARTE ARRIBA CAJA
9008 Y$=CHR$(158)+CHR$(198)+CHR$(199): REM PARTE ABAJO CAJA

9100 POKE 788,52: REM DESACTIVAR RUN/STOP
9105 VB=0: SP=49152: REM VIC II BANK 3
9110 REM SELECT VIDEO BANK
9130 POKE 56578,PEEK(56578) OR 3
9140 POKE 56576,(PEEK(56576) AND 252) OR VB
9150 REM SET SCREEN MEMORY ADDRESS
9160 A = 16: REM MEANS (VIC BASE) + 1024 = 50176
9170 POKE 53272,(PEEK(53272) AND 15) OR A
9180 REM SET CHARSET MEMORY
9190 A = 12
9200 POKE 53272,(PEEK(53272) AND 240) OR A
9210 REM SET SCREEN MEMORY ADDRESS FOR KERNAL
9220 POKE 648,(SP + 1024)/256: REM 196 = 50176 / 256

9310 REM DISABLE INTERRUPTS AND REVEAL CHARACTER ROM 
9311 POKE 56334,PEEK(56334) AND 254
9312 POKE 1,PEEK(1) AND 251
9313 REM COPY CHARACTER SET DOWN TO RAM
9314 PRINT CHR$(147): POKE 781,10: POKE 782,11: SYS 65520: PRINT "GENERANDO GRAFICOS": POKE 781,12: POKE 782,10: SYS 65520: PRINT "ESPERA UNOS MOMENTOS" 
9315 FOR I=0 TO 256*8-1
9316 POKE SP+12288+I,PEEK(53248+I)
9317 NEXT I
9318 REM COVER UP CHARACTER ROM AND REENABLE INTERRUPTS
9319 POKE 1,PEEK(1) OR 4
9320 POKE 56334,PEEK(56334) OR 1

9400 REM REDEFINE CHARSET
9450 RESTORE: SP=49152
9451 FOR I=0 TO 17
9452 READ C
9454 FOR J=0 TO 7
9455 READ A: POKE SP+12288+C*8+J,A
9456 NEXT J: NEXT I

9499 RETURN
